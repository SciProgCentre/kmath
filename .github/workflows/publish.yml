name: Bintray Publish

on:
    release:
        types:
            - created

jobs:
    build-on-windows:
        runs-on: windows-latest
        steps:
            -   uses: actions/checkout@v2
            -   name: Set up JDK 11
                uses: actions/setup-java@v1
                with:
                    java-version: 11
            -   name: Grant execute permission for gradlew
                run: chmod +x gradlew
            -   name: Gradle clean
                run: ./gradlew clean
            -   name: Gradle build
                run: ./gradlew build 
            -   name: Run release task
                run: ./gradlew release -PbintrayUser=${{ secrets.BINTRAY_USER }} -PbintrayApiKey=${{ secrets.BINTRAY_KEY }}
    build-on-macos:
        runs-on: macos-latest
        steps:
            -   uses: actions/checkout@v2
            -   name: Set up JDK 11
                uses: actions/setup-java@v1
                with:
                    java-version: 11
            -   name: Grant execute permission for gradlew
                run: chmod +x gradlew
            -   name: Gradle clean
                run: ./gradlew clean
            -   name: Gradle build
                run: ./gradlew build
            -   name: Run release task
                run: ./gradlew release -PbintrayUser=${{ secrets.BINTRAY_USER }} -PbintrayApiKey=${{ secrets.BINTRAY_KEY }}
